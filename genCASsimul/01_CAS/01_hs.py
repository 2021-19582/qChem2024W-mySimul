#!/usr/bin/env python

# TODO
mysimulstr = '01'


from pyscf import scf
from pyscf import gto,dft

mol = gto.Mole()
mol.verbose = 6
mol.output = mysimulstr+'_hs_bp86.out'
mol.atom = """  Fe                 5.22000000    1.05000000   -7.95000000
S                  3.86000000   -0.28000000   -9.06000000
S                  5.00000000    0.95000000   -5.660
S                  4.77000000    3.18000000   -8.740
S                  7.23000000    0.28000000   -8.380
Fe                 5.88000000   -1.05000000   -9.490
S                  6.10000000   -0.95000000  -11.790
S                  6.33000000   -3.18000000   -8.710
C                  6.00000000    4.34000000   -8.170
H                  6.46000000    4.81000000   -9.010
H                  5.53000000    5.08000000   -7.550
H                  6.74000000    3.82000000   -7.600
C                  3.33000000    1.31000000   -5.180
H                  2.71000000    0.46000000   -5.370
H                  3.30000000    1.54000000   -4.130
H                  2.97000000    2.15000000   -5.730
C                  5.10000000   -4.34000000   -9.280
H                  5.56000000   -5.05000000   -9.930
H                  4.67000000   -4.84000000   -8.440
H                  4.34000000   -3.81000000   -9.810
C                  7.77000000   -1.31000000  -12.270
H                  7.84000000   -1.35000000  -13.340
H                  8.42000000   -0.54000000  -11.900
H                  8.06000000   -2.25000000  -11.860
"""

mol.basis = 'tzp-dkh'
mol.charge = -2
mol.spin = 10 #na-nb
mol.build()

mf = scf.sfx2c(scf.UKS(mol))
mf.chkfile = mysimulstr+'hs_bp86.chk'
mf.max_cycle = 500
mf.conv_tol = 1.e-4
mf.xc = 'b88,p86' 
mf.scf()

mf2 = scf.newton(mf)
#mf2.ah_start_tol = 1.e-8
#mf2.ah_conv_tol = 1.e-14
mf2.conv_tol = 1.e-12
mf2.kernel()
